document.addEventListener("DOMContentLoaded", () => {
    // Language Toggle
    const btnLanguage = document.querySelector(".btn-language")
    const btnLanguageMobile = document.querySelector(".btn-language-mobile")
    const languageIndicator = document.querySelector(".language-indicator")
    let currentLanguage = localStorage.getItem("language") || "en"
  
    // Set initial language
    setLanguage(currentLanguage)
  
    // Language toggle event listeners
    if (btnLanguage) {
      btnLanguage.addEventListener("click", toggleLanguage)
    }
  
    if (btnLanguageMobile) {
      btnLanguageMobile.addEventListener("click", toggleLanguage)
    }
  
    function toggleLanguage() {
      currentLanguage = currentLanguage === "en" ? "zh" : "en"
      localStorage.setItem("language", currentLanguage)
      setLanguage(currentLanguage)
    }
  
    function setLanguage(lang) {
      if (languageIndicator) {
        languageIndicator.textContent = lang.toUpperCase()
      }
  
      // Update all translatable elements
      const elements = document.querySelectorAll("[data-i18n]")
      elements.forEach((el) => {
        const key = el.getAttribute("data-i18n")
        if (translations[lang] && translations[lang][key]) {
          el.textContent = translations[lang][key]
        }
      })
    }
  
    // Mobile Menu Toggle
    const menuToggle = document.querySelector(".menu-toggle")
    const mobileMenu = document.querySelector(".mobile-menu")
  
    if (menuToggle && mobileMenu) {
      menuToggle.addEventListener("click", () => {
        mobileMenu.classList.toggle("active")
  
        // Toggle menu icon
        const icon = menuToggle.querySelector("i")
        if (icon) {
          if (mobileMenu.classList.contains("active")) {
            icon.classList.remove("lucide-menu")
            icon.classList.add("lucide-x")
          } else {
            icon.classList.remove("lucide-x")
            icon.classList.add("lucide-menu")
          }
        }
      })
    }
  
    // Smooth Scrolling
    const scrollLinks = document.querySelectorAll("[data-scroll-to]")
  
    scrollLinks.forEach((link) => {
      link.addEventListener("click", function (e) {
        e.preventDefault()
        const targetId = this.getAttribute("data-scroll-to")
        const targetElement = document.getElementById(targetId)
  
        if (targetElement) {
          // Close mobile menu if open
          if (mobileMenu && mobileMenu.classList.contains("active")) {
            mobileMenu.classList.remove("active")
            const icon = menuToggle.querySelector("i")
            if (icon) {
              icon.classList.remove("lucide-x")
              icon.classList.add("lucide-menu")
            }
          }
  
          // Scroll to target
          const navbarHeight = document.querySelector(".navbar").offsetHeight
          const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - navbarHeight
  
          window.scrollTo({
            top: targetPosition,
            behavior: "smooth",
          })
        }
      })
    })
  
    // Modal Functionality
    const modals = document.querySelectorAll(".modal")
    const modalTriggers = {
      loginModal: [document.getElementById("loginBtn"), document.getElementById("loginBtnMobile")],
      downloadModal: [document.getElementById("downloadBtn"), document.getElementById("downloadBtnCta")],
    }
  
    // Setup modal triggers
    for (const [modalId, triggers] of Object.entries(modalTriggers)) {
      const modal = document.getElementById(modalId)
  
      if (modal) {
        triggers.forEach((trigger) => {
          if (trigger) {
            trigger.addEventListener("click", () => {
              modal.classList.add("active")
            })
          }
        })
  
        // Close modal with close button
        const closeBtn = modal.querySelector(".modal-close")
        if (closeBtn) {
          closeBtn.addEventListener("click", () => {
            modal.classList.remove("active")
          })
        }
  
        // Close modal when clicking outside
        modal.addEventListener("click", (e) => {
          if (e.target === modal) {
            modal.classList.remove("active")
          }
        })
      }
    }
  
    // Login Form Handling
    const loginForm = document.getElementById("loginForm")
    if (loginForm) {
      loginForm.addEventListener("submit", (e) => {
        e.preventDefault()
        const email = document.getElementById("email").value
        const password = document.getElementById("password").value
  
        console.log("Login attempt with:", email, password)
        // Here you would typically send the data to a server
  
        // Close the modal after submission
        const modal = document.getElementById("loginModal")
        if (modal) {
          modal.classList.remove("active")
        }
      })
    }
  
    // Tab Functionality
    const tabButtons = document.querySelectorAll(".tab-btn")
  
    tabButtons.forEach((button) => {
      button.addEventListener("click", function () {
        const tabId = this.getAttribute("data-tab")
        const tabContainer = this.closest(".download-tabs, .info-tabs")
  
        if (tabContainer) {
          // Deactivate all tabs
          const allTabs = tabContainer.querySelectorAll(".tab-pane")
          const allButtons = tabContainer.querySelectorAll(".tab-btn")
  
          allTabs.forEach((tab) => tab.classList.remove("active"))
          allButtons.forEach((btn) => btn.classList.remove("active"))
  
          // Activate selected tab
          this.classList.add("active")
          const selectedTab = document.getElementById(`${tabId}-tab`)
          if (selectedTab) {
            selectedTab.classList.add("active")
          }
        }
      })
    })
  
    // Video Player Functionality
    const videoElement = document.getElementById("demoVideo")
    const videoPlayBtn = document.querySelector(".video-play-btn")
    const videoOverlay = document.querySelector(".video-overlay")
  
    if (videoElement && videoPlayBtn && videoOverlay) {
      videoPlayBtn.addEventListener("click", toggleVideo)
  
      function toggleVideo() {
        if (videoElement.paused) {
          videoElement.play()
          videoOverlay.style.opacity = "0"
          videoPlayBtn.innerHTML = '<i class="lucide lucide-pause"></i>'
        } else {
          videoElement.pause()
          videoOverlay.style.opacity = "1"
          videoPlayBtn.innerHTML = '<i class="lucide lucide-play"></i>'
        }
      }
  
      // Auto-play video when scrolled into view
      const videoSection = document.querySelector(".video-section")
      if (videoSection) {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting && videoElement.paused) {
                // Try to play video when it comes into view
                videoElement
                  .play()
                  .then(() => {
                    videoOverlay.style.opacity = "0"
                    videoPlayBtn.innerHTML = '<i class="lucide lucide-pause"></i>'
                  })
                  .catch((error) => {
                    console.error("Video play failed:", error)
                    // Keep overlay visible if autoplay fails (common on mobile)
                  })
              } else if (!entry.isIntersecting && !videoElement.paused) {
                videoElement.pause()
                videoOverlay.style.opacity = "1"
                videoPlayBtn.innerHTML = '<i class="lucide lucide-play"></i>'
              }
            })
          },
          { threshold: 0.5 },
        )
  
        observer.observe(videoSection)
      }
    }
  })
  
  // Translations
  const translations = {
    en: {
      // Navbar
      features: "Features",
      howItWorks: "How It Works",
      team: "Team",
      login: "Login",
  
      // Hero Section
      heroTitle: "AI-Powered Nutritional Search",
      heroSubtitle:
        "Discover the nutritional content of any food with just a photo or text search, powered by advanced AI.",
      downloadNow: "Download Now",
      learnMore: "Learn More",
  
      // Features Section
      featuresTitle: "Key Features",
      feature1Title: "Image Recognition",
      feature1Description: "Take a photo of any food and get instant nutritional information.",
      feature2Title: "Natural Language Search",
      feature2Description: "Simply describe the food you're looking for in natural language.",
      feature3Title: "Comprehensive Data",
      feature3Description: "Get detailed nutritional breakdown including calories, macros, vitamins, and more.",
  
      // How it Works Section
      howItWorksTitle: "How It Works",
      step1: "Take a photo or enter a description",
      step2: "Our AI analyzes the content",
      step3: "Get detailed nutritional information",
      step4: "Make informed dietary choices",
  
      // Team Section
      teamTitle: "Meet Our Team",
      teamDescription: "The brilliant minds behind InfiniteLoopers",
  
      // CTA Section
      ctaTitle: "Ready to Transform Your Nutrition?",
      ctaSubtitle: "Download our app today and start making smarter food choices.",
      downloadApp: "Download App",
  
      // Footer
      copyright: "Â© 2025 InfiniteLoopers. All rights reserved.",
  
      // Video Section
      videoTitle: "See It In Action",
      videoSubtitle: "Watch how our app works in real time",
  
      // QR Code Modal
      scanToDownload: "Scan QR Code to Download",
      downloadOptions: "Download Options",
      downloadAndroid: "Download for Android",
      downloadIOS: "Download for iOS",
      closeModal: "Close",
  
      // Learn More Page
      backToHome: "Back to Home",
      learnMoreTitle: "Discover InfiniteLoopers",
      learnMoreDescription1:
        "InfiniteLoopers Nutritional Search App is an AI-powered mobile application that allows users to search for food items and receive comprehensive nutritional information instantly.",
      learnMoreDescription2:
        "Using advanced image recognition and natural language processing, our app helps users make informed choices about their diet with just a few taps.",
      viewGitHub: "View on GitHub",
      detailedFeatures: "Features",
      technicalInfo: "Technical Info",
      aboutTeam: "Team",
      feature1Detail: "Advanced image recognition identifies food items from photos with high accuracy",
      feature2Detail: "Natural language processing understands complex food queries",
      feature3Detail: "Comprehensive nutritional database covering thousands of food items",
      feature4Detail: "Personalized recommendations based on your dietary preferences",
      techStack: "Technology Stack",
      aiModels: "AI Models",
      aiModelsDetail: "Custom-trained image recognition and NLP models",
      dataProcessing: "Data Processing",
      dataProcessingDetail: "Real-time data analysis with edge computing for fast results",
      apiIntegration: "API Integration",
      apiIntegrationDetail: "Integrated with comprehensive nutritional databases",
      teamDescription:
        "Our team consists of five passionate developers from the University of South Carolina who are dedicated to making nutritional information more accessible.",
    },
    zh: {
      // å¯¼èªæ 
      features: "æ ¸å¿åè½",
      howItWorks: "å·¥ä½åç",
      team: "å¢éæå",
      login: "ç»å½",
  
      // è±éåºå
      heroTitle: "AIé©±å¨çè¥å»æç´¢",
      heroSubtitle: "éè¿ç§çææå­æç´¢ï¼åå©åè¿çAIææ¯ï¼å³å»äºè§£ä»»ä½é£ç©çè¥å»æåã",
      downloadNow: "ç«å³ä¸è½½",
      learnMore: "äºè§£æ´å¤",
  
      // åè½åºå
      featuresTitle: "æ ¸å¿åè½",
      feature1Title: "å¾åè¯å«",
      feature1Description: "ææä»»ä½é£ç©çç§çï¼ç«å³è·åè¥å»ä¿¡æ¯ã",
      feature2Title: "èªç¶è¯­è¨æç´¢",
      feature2Description: "åªéç¨èªç¶è¯­è¨æè¿°æ¨è¦æ¥æ¾çé£ç©ã",
      feature3Title: "å¨é¢æ°æ®",
      feature3Description: "è·åè¯¦ç»çè¥å»åæï¼åæ¬ç­éãå®éè¥å»ç´ ãç»´çç´ ç­ã",
  
      // å·¥ä½åçåºå
      howItWorksTitle: "å·¥ä½åç",
      step1: "æç§æè¾å¥æè¿°",
      step2: "AIåæåå®¹",
      step3: "è·åè¯¦ç»è¥å»ä¿¡æ¯",
      step4: "ååºææºçé¥®é£éæ©",
  
      // å¢éåºå
      teamTitle: "å¢éæå",
      teamDescription: "InfiniteLoopersèåçä¼ç§å¢é",
  
      // è¡å¨å¬å¤åºå
      ctaTitle: "åå¤æ¹åæ¨çè¥å»æ¹å¼ï¼",
      ctaSubtitle: "ä»å¤©å°±ä¸è½½æä»¬çåºç¨ï¼å¼å§ååºæ´ææºçé£ç©éæ©ã",
      downloadApp: "ä¸è½½åºç¨",
  
      // é¡µè
      copyright: "Â© 2025 InfiniteLoopers. ä¿çæææå©ã",
  
      // è§é¢åºå
      videoTitle: "å®éæä½æ¼ç¤º",
      videoSubtitle: "è§çæä»¬çåºç¨å®æ¶å·¥ä½",
  
      // äºç»´ç æ¨¡ææ¡
      scanToDownload: "æ«æäºç»´ç ä¸è½½",
      downloadOptions: "ä¸è½½éé¡¹",
      downloadAndroid: "ä¸è½½å®åç",
      downloadIOS: "ä¸è½½iOSç",
      closeModal: "å³é­",
  
      // äºè§£æ´å¤é¡µé¢
      backToHome: "è¿åé¦é¡µ",
      learnMoreTitle: "æ¢ç´¢ InfiniteLoopers",
      learnMoreDescription1:
        "InfiniteLoopersè¥å»æç´¢åºç¨æ¯ä¸æ¬¾AIé©±å¨çç§»å¨åºç¨ï¼åè®¸ç¨æ·æç´¢é£åé¡¹ç®å¹¶ç«å³è·åå¨é¢çè¥å»ä¿¡æ¯ã",
      learnMoreDescription2:
        "éè¿åè¿çå¾åè¯å«åèªç¶è¯­è¨å¤çææ¯ï¼æä»¬çåºç¨å¸®å©ç¨æ·åªéå æ¬¡ç¹å»å³å¯å¯¹é¥®é£ååºææºçéï¿½ï¿½ã",
      viewGitHub: "å¨GitHubä¸æ¥ç",
      detailedFeatures: "åè½è¯¦æ",
      technicalInfo: "ææ¯ä¿¡æ¯",
      aboutTeam: "å³äºå¢é",
      feature1Detail: "åè¿çå¾åè¯å«ææ¯å¯ä»¥é«ç²¾åº¦è¯å«ç§çä¸­çé£ç©",
      feature2Detail: "èªç¶è¯­è¨å¤ççè§£å¤æçé£ç©æ¥è¯¢",
      feature3Detail: "å¨é¢çè¥å»æ°æ®åºè¦çæ°åç§é£ç©",
      feature4Detail: "åºäºæ¨çé¥®é£åå¥½æä¾ä¸ªæ§åæ¨è",
      techStack: "ææ¯æ ",
      aiModels: "AIæ¨¡å",
      aiModelsDetail: "å®å¶è®­ç»çå¾åè¯å«åNLPæ¨¡å",
      dataProcessing: "æ°æ®å¤ç",
      dataProcessingDetail: "ä½¿ç¨è¾¹ç¼è®¡ç®è¿è¡å®æ¶æ°æ®åæï¼ä»¥è·å¾å¿«éç»æ",
      apiIntegration: "APIéæ",
      apiIntegrationDetail: "ä¸å¨é¢çè¥å»æ°æ®åºéæ",
      teamDescription: "æä»¬çå¢éç±æ¥èªåå¡ç½æ¥çº³å¤§å­¦çäºä½åæ»¡ç­æçå¼åäººåç»æï¼ä»ä»¬è´åäºä½¿è¥å»ä¿¡æ¯æ´å æäºè·åã",
    },
  }
  
  